# ============================================
# PopupChatKit 环境变量配置
# ============================================
# 使用说明:
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 填入你的实际配置值
# 3. 不要将 .env 文件提交到版本控制

# ============================================
# AI 模型配置
# ============================================

# 智谱 AI API Key
# 获取地址: https://open.bigmodel.cn/
ZHIPU_API_KEY=a58dc049679f434d8542ce3c61568ae3.thO9ZHXnqXEBW0py
OPENAI_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
# 通义千问 API Key
# 获取地址: https://dashscope.aliyun.com/
QWEN_API_KEY=your_qwen_api_key_here

# 默认使用的模型 (zhipu | qwen)
DEFAULT_MODEL=zhipu

# ============================================
# 数据库配置
# ============================================

# SQLite 数据库文件路径
DB_PATH=../data/chat.db

# 是否启用 WAL 模式 (提升并发性能)
DB_WAL_MODE=true

# 数据库连接池大小
DB_POOL_SIZE=5

# ============================================
# 服务器配置
# ============================================

# 监听地址
HOST=0.0.0.0

# 监听端口
PORT=8000

# 是否开启调试模式
DEBUG=true

# 是否开启热重载 (开发环境)
RELOAD=true

# 工作进程数 (生产环境)
WORKERS=4

# ============================================
# 安全配置
# ============================================

# JWT 密钥 (使用随机字符串,生产环境务必修改)
# 生成方法: openssl rand -hex 32
SECRET_KEY=your-secret-key-change-this-in-production

# JWT 算法
ALGORITHM=HS256

# Access Token 过期时间 (分钟)
ACCESS_TOKEN_EXPIRE_MINUTES=30

# 是否启用 API Key 加密存储
ENCRYPT_API_KEYS=true

# 加密密钥 (用于加密存储 API Key)
ENCRYPTION_KEY=your-encryption-key-here

# ============================================
# CORS 配置
# ============================================

# 允许的源 (逗号分隔,* 表示允许所有)
# 生产环境建议设置具体域名
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000,http://127.0.0.1:8000

# 是否允许凭证
ALLOW_CREDENTIALS=true

# 允许的 HTTP 方法
ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS

# 允许的请求头
ALLOWED_HEADERS=*

# ============================================
# 日志配置
# ============================================

# 日志级别 (DEBUG | INFO | WARNING | ERROR | CRITICAL)
LOG_LEVEL=INFO

# 日志文件路径 (为空则只输出到控制台)
LOG_FILE=

# 是否启用 JSON 格式日志
LOG_JSON=false

# Logfire Token (可选,用于监控)
# 获取地址: https://logfire.pydantic.dev/
LOGFIRE_TOKEN=

# 是否发送日志到 Logfire
LOGFIRE_SEND=false

# ============================================
# 功能开关
# ============================================

# 是否启用流式响应
ENABLE_STREAM=true

# 是否启用网页提取功能
ENABLE_WEB_EXTRACT=true

# 是否启用图片分析功能
ENABLE_IMAGE_ANALYSIS=true

# 是否启用 AI 绘画功能
ENABLE_DRAW=true

# 是否启用 MCP 协议 (预留)
ENABLE_MCP=false

# ============================================
# 限流配置
# ============================================

# 是否启用限流
ENABLE_RATE_LIMIT=true

# 每分钟最大请求数
RATE_LIMIT_PER_MINUTE=60

# 每小时最大请求数
RATE_LIMIT_PER_HOUR=1000

# ============================================
# 缓存配置
# ============================================

# 是否启用缓存
ENABLE_CACHE=true

# 缓存类型 (memory | redis)
CACHE_TYPE=memory

# Redis 连接 URL (如果使用 Redis 缓存)
REDIS_URL=redis://localhost:6379/0

# 网页内容缓存时间 (秒)
WEB_CACHE_TTL=86400

# ============================================
# AI 模型参数
# ============================================

# 默认温度参数 (0.0-1.0)
DEFAULT_TEMPERATURE=0.7

# 默认最大 Token 数
DEFAULT_MAX_TOKENS=2000

# 是否启用上下文压缩
ENABLE_CONTEXT_COMPRESSION=false

# 最大上下文长度
MAX_CONTEXT_LENGTH=4000

# ============================================
# 文件上传配置
# ============================================

# 上传文件存储路径
UPLOAD_DIR=../data/uploads

# 最大文件大小 (MB)
MAX_FILE_SIZE=10

# 允许的图片格式 (逗号分隔)
ALLOWED_IMAGE_FORMATS=jpg,jpeg,png,gif,webp

# ============================================
# 前端配置
# ============================================

# 前端静态文件路径
FRONTEND_DIR=../frontend

# 是否启用静态文件服务
SERVE_STATIC=true

# ============================================
# 监控和统计
# ============================================

# 是否启用使用统计
ENABLE_USAGE_STATS=true

# 统计数据保留天数
STATS_RETENTION_DAYS=90

# 是否启用性能监控
ENABLE_PERFORMANCE_MONITORING=false

# ============================================
# 数据清理配置
# ============================================

# 是否启用自动数据清理
ENABLE_AUTO_CLEANUP=true

# 会话保留天数 (超过此天数的会话将被清理)
SESSION_RETENTION_DAYS=90

# 缓存清理间隔 (小时)
CACHE_CLEANUP_INTERVAL=24

# ============================================
# 开发环境专用配置
# ============================================

# 是否显示 SQL 查询日志
SHOW_SQL_QUERIES=false

# 是否启用 API 文档
ENABLE_API_DOCS=true

# API 文档路径
DOCS_URL=/docs

# OpenAPI JSON 路径
OPENAPI_URL=/openapi.json

# ============================================
# 生产环境建议
# ============================================
# 1. DEBUG 设置为 false
# 2. SECRET_KEY 使用强随机字符串
# 3. ALLOWED_ORIGINS 设置具体域名
# 4. 启用 HTTPS
# 5. 配置反向代理 (Nginx/Caddy)
# 6. 启用日志记录
# 7. 定期备份数据库
# 8. 监控系统资源使用
